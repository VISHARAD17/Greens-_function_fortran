program greens

    implicit none

    real :: h,V,r0,r1

    print *,'please enter h and v'
    read *,h,V

    call GRADIF(h,V,r0,r1)

    print *, 'results' ,r0,r1

end program greens

    SUBROUTINE GRADIF (H ,V,R0,R1 )
    REAL, INTENT(OUT) :: R0, R1
    DIMENSION P(15),Q(10)
    DIMENSION PE (10),QE(10)
    DIMENSION TA(10) ,TB(10) ,TC(10) ,TD (10)
    ELLIPS = H*H+.64*V*V
    IF(ELLIPS .LT. 144.0) GO TO 200

!***********************************************
!           ASYMPTOTIC EXPANSIONS
!***********************************************

! ** (H/12)**2+(V/15)**2 .GE. 1.0    (MAJOR AXIS)/(HINOR AXIS) = 0.8


    D = SQRT(H ** 2 + V ** 2)
    DI = 1./D
    A = -V * DI
    A2 = A + A
    P(1) = A
    A = A+A2
    Q(1) = A
    P(2) = A*P(1)-1.0
    A = A + A2
    Q(2) = A*Q(1)- 3.0
    P(3) = A*P(2)- 4.*P(1)
    A = A + A2
    Q(3) = A*Q(2)-8.*Q(1)
    P(4) = A*P(3)-9.*P(2)
    A = A + A2
    Q(4) = A*Q(3)-15.*Q(2)
    P(5) = A*P(4)-16.*P(3)
    IF(ELLIPS .GT. 256.0) GO TO 120
! ** (H/16) ** 2+(V/20)**2 .LE. 1.0 (MAJOR AXIS)/(MINOR AXIS) = 0.8

    A = A+A2
    Q(5) = A*Q(4)-24.*Q(3)
    P(6) = A*P(5)-25.*P(4)
    A = A+A2
    Q(6) = A*Q(5)-35.*Q(4)
    P(7) = A*P(6)-36.*P(5)
    A = A+A2
    Q(7) = A*Q(6)-48.*Q(5)
    P(8) = A*P(7)-49.*P(6)
    A = A+A2
    Q(8) = A*Q(7)-63.*Q(6)
    P(9) = A*P(8)-64.*P(7)
    A = A+A2
    Q(9) = A*Q(8)-80.*Q(7)
    P(10) = A*P(9)-81.*P(8)
    R0 = (((((((((P(10)*DI + P(9))*DI+P(8))*DI+P(7))*DI+P(6))*DI &
         +P(5))*DI+P(4))*DI+P(3))*DI+P(2))*DI+P(1))*DI + 1.0

    R1 = ((((((((Q(9)*DI+Q(8))*DI+Q(7))*DI+Q(6))*DI &
        +Q(5))*DI+Q(4))*DI+Q(3))*DI+Q(2))*DI+Q(1))*DI + 1.0
    GO TO 130

120 R0 = ((((P(5)*DI+P(4))*DI+P(3))*DI+P(2))*DI+P(1))*DI + 1.0
    R1 = (((Q(4)*DI+Q(3))*DI+Q(2))*DI+Q(1))*DI+1.0
130 R1 = -H*R1*DI*DI*DI
    R0 = -R0 * DI
    IF(V .LT. -14.5) GO TO 199

! ** SUBTRACT PI*EXP(V) * Y0(H) AND PI*EXP(V)*YI(H).
! ** FOR H .GE. 3.0, Y0(H) = BFYO + EPSO AND Y1(H) = BFY1 + EPS1 WHERE
! ** EPS0 AND EPS1 ARE LESS THAN 3.0E-08. FOR -14.5 .LE. V .LE. 0.0,
! ** PI*EXP(V) = EV + EPS3 WHERE EPS3 .LE. 3.2E-07.

    EV = ((((-.000000351*V+.000009652)*V -.000326627)*V &
         +.007811604)*V-.125000204)*V + 1.0
    EV = 3.1415926535/((EV**2)**2)**2
    IF(H .GT. 9.28) GO TO 160

! ** RATIONAL APPROXIMATIONS FOR Y0 AND Y1.

    T = 0.3184713375796*H-1.9554140127
    BFY0 = (((((((.021767356*T- .052309304)*T+ .212313014)*T &
           -.189610347)*T- 1.076135896)*T+ .952106070)*T+ .681499765)*T &
           -.261255619)/((((((.008780136*T- .003763483)*T + .077454833)*T &
           -.028968754)*T+.402833434)*T-.095517974)*T+1.0)
    BFY1 = (((((((.047994674*T+.029867756)*T-.430960003)*T &
          -.373212227)*T+1.213175696)*T+.827893282)*T-.802276681)*T &
          -.209090795)/((((((.002750217*T+.010244382)*T+.034701086)*T &
          +.101734168)*T+.261902970)*T+.424998688)*T+1.0)
    GO TO 190
160 IF(H .GT. 15.56) GO TO 170

! ** RATIONAL APPROXIMATIONS FOR Y0 AND Y1.

    T = 0.3184713375796*H-3.9554140127
    BFY0 = ((((((.061701265*T+.104237686)*T-.491950725)*T &
           -.498150278)*T + .868689138)*T+.407226341)*T-.182998984)/ &
           ((((((.006469967*T+.007680177)*T+.056994295)*T &
           +.055720425)*T+.329861784)*T+.187347997)*T+1.0)
    BFY1 = ((((((.066047514*T-.116599621)*T-.470154792)*T &
           +.610073355)*T+.742684701)*T-.531628605)*T-.140608432)/ &
           ((((((.005223360*T-.002436315)*T+.048562436)*T &
           -.016644207)*T+.303401116)*T-.052913586)*T+1.0)
    GO TO 190
170 IF(H .GT. 21.84) GO TO 180

! ** RATIONAL APPROXIMATIONS FOR YO AND YI.

    T = 0.3184713375796*H-5.9554140127
    BFY0 = ((((((.053135824*T+.080473588)*T-.412042079)*T &
         -.393689874)*T+.714974165)*T+.328907850)*T-.149152825)/ &
          ((((((.006357898*T+.006846119)*T+.056366419)*T &
         +.049348540)*T+.328217846)*T+.164959082)*T+1.0) 
    BFY1 = ((((((.052061033*T-.101565247)*T-.370667025)*T &
         +.516399454)*T+.589317123)*T-.440922817)*T-.112583341)/ &
         ((((((.006198559*T-.003547471)*T+.053819968)*T &
         -.024026136)*T+.318223820)*T-.075614615)*T+1.0)
    GO TO 190
180 CONTINUE

! ** APPROXIMATIONS FOR YO AND Y1 FROM NEWMAN.

    HI = 1./H
    HI2 = HI**2
    F0 = ((3.02562477*HI2+5.46272781)*HI2+.79788454)/ &
         ((4.12217805*HI2+6.90899779)*HI2+1.0)
    F1 = ((2.58896576*HI2+4.76650390)*HI2+.79788459)/ &
         ((2.35033517*HI2+5.78645312)*HI2+1.0)
    THETA0 = ((-.75853664*HI2-1.07437411)*HI2-.12499967)/ &
         ((9.19906287*HI2+9.1151)*HI2+1.)
    THETA0 = THETA0*HI+H -.7853981634
    THETA1 = ((1.39381402*HI2+2.77870488)*HI2+.37499947)/ &
         ((6.19124657*HI2+7.84700458)*HI2+1.0)
    THETA1 = THETA1*HI+H-2.356194490
    SQ = SQRT(HI)
    BFY0 = SQ*F0*SIN(THETA0)
    BFY1 = SQ*F1*SIN(THETA1)
190 CONTINUE
    R0 = R0-EV*BFY0
    R1 = R1-EV*BFY1
199 RETURN
200 IF (V .LT. -2.0 .OR. H .GT. 1.2-0.15*V) GO TO 300

! *** 0.0 .LE. H .LE. 1.2-0.15*V
! *** -2 .LE. V .LE. 0.0
! ****************************************************************
!               ASCENDING SERIES
! ****************************************************************

    H2 = H*H
    D = SQRT(H2+V*V)
    HD2 = -H*0.5
    T = HD2*HD2
    S = H/(D-V)
    S2 = S*S

! *** CALCULATE THE COEFFICIENTS FI, F2, F3, F4, AND F5 FOR THE SERIES
! *** TO AND ITS DERIVATIVE TOP FROM RATIONAL FITS.
! *** ERROR .LT. 2.3E-07 FOR F1    ERROR .LT. 1.2E-07 FOR F2
! *** ERROR .LT. 1.9E,-O7 FOR F3   ERROR .LT..40 E-07 FOR F4
! *** ERROR .LT..019Â£-07 FOR F5

    F1 = -((V+.8173440074)*V+62.86545852)/(((.5408446260*V &
         -5.147756045)*V+22.73891687)*V-41.91029926)
    F2 = -((.617241992*V+2.467761402)*V+37.27126886)/ &
         (((V-9.099249981)*V+39.34413574)*V-71.56082044)
    F3 = -((.08074845476*V+.4238013108)*V+ 4.559486078)/ &
         (((V-8.798679103)*V+37.33112079)*V-66.99651168)
    F4 = ((.001253874953*V+.01087140573)*V +.05634728099)/ &
         ((V-5.728779471)*V+11.94187379)

! *** CALCULATE THE SERIES TO AND ITS N-DERIVATIVE TOP.
! *** CALCULATE THE SERIES SO AND TWICE ITS H-DERIVATIVE SOP.

    IF (H .LE. 0.55-.2*V) GO TO 210

! *** EXTRA CALCULATION FOR TO, TOP, SO, AND SOP.
    F5 = ((.5579548000E-04*V+.4821895323E-03)*V+.002360870818)/ &
         ((V-5.630204187)*V+11.60710801)
    T0P = F5*T
    T0 = F4-T0P
    T0P = T0-T0P
    T0 = F3-T0*T
    T0P = T0-T0P*T
    S0 = (((0.275573192240E-07*S2-0.344466490300E-06)*S2 &
         +0.206679894180E-05)*S2-0.826719576720E-05)*S2 &
         +.289351851852E-04
    S0 = S0*T+((0.310019841270E-05*S2-0.330687830688E-04)*S2 &
         +0.173611111111E-03)*S2-0.694444444444E-03
    S1 = (((0.306192435822E-06*S2-0.354308390023E-05)*S2 &
         +0.198412698413E-04)*S2-0.771604938272E-04)*S2+0.347222222222E-03
    S0P = (((-.137786595915E-06*S2+.206679894129E-05)*S2 &
          -.165343915339E-04)*S2+.115740740740E-03)*S2+.347222222222E-03
    S0P = S0P*T+((-.165343915331E-04*S2+.231481481478E-03)*S2 &
          -.208333333333E-02)*S2-.694444444444E-02
    S1P = (((-.157470395940E-05*S2+.226757369706E-04)*S2 &
          -.185185185192E-03)*S2+.185185185185E-02)*S2+.347222222222E-02
    GO TO 211
210 CONTINUE

! *** LESS CALCULATION FOR TO, TOP, SO, AND SOP.

    T0P = F4*T
    T0 = F3-T0P
    T0P = T0-T0P
    S0 = 0.0
    S1 = 0.0
    S0P = 0.0
    S1P = 0.0
211 CONTINUE

! *** FINISH CALCULATING T0, T0P, S0, AND S0P.

    T0 = F2-T0*T
    T0P = T0-T0P*T
    T0 = F1-T0*T
    T0P = T0-T0P*T
    T0 = -T0*T
    T0P = HD2*T0P
    S0 = S0*T+(0.231481481481E-03*S2-.00208333333333)*S2 &
        +.0104166666667
    S0 = S0*T+.0104166666667*S2-.0833333333333
    S0 = (S0*T+0.25)*T*S2
    S1 = S1*T+((0.283446712018E-04*S2-0.277777777778E-03)*S2 &
        +.00138888888889)*S2-.00694444444444
    S1 = S1*T+(.00166666666667*S2-.0138888888889)*S2+.0833333333333
    S1 = S1*T+.0555555555556*S2-.5
    S1 = (S1*T+1.0)*HD2*S
    S0 = S0+S1
    S0P = S0P*T+(-.138888888889E-02*S2+.208333333333E-01)*S2 &
        +.833333333333E-01
    S0P = S0P*T-0.8333333333333E-01*S2-0.5
    S0P = (S0P*T+1.0)*S2*HD2
    S1P = S1P*T+((-.158730158723E-03*S2+.222222222220E-02)*S2 &
        -.277777777777E-01)*S2-.555555555555E-01
    S1P = S1P*T+(-.111111111110E-01*S2+.222222222222)*S2+.5
    S1P = S1P*T-0.6666666666667*S2-2.0
    S1P = (S1P*T+2.0)*S
    S0P = -(S0P+S1P)/(1.0+S2)

! *** CALCULATE EV = EXP(V) WITH ERROR 8.7E-08 FOR -2.LE.V.LE.0.

    T = V+1.
    EV = (((.00313774*T+.03737560)*T+.18526324)*T+.36787948) &
        /(((-.00794426*T+.09800193)*T-.49640162)*T+1.0)

! *** CALCULATE EVE1 = EXP(V)*(E1(V)+ALOG(V)+GAMMA) TO ACCURACCY 2.1E-07
! *** USING A RATIONAL FIT FOR -2.LE.V.LE.0.0.

    EVE1 = -(((.802276746*V+9.423416163)*V+55.273264995)*V &
        +.113520672E-04)/(((V-7.9127451988)*V+32.0385920659)*V &
        -55.2725293008)
    ALG = ALOG(D-V)

! *** CALCULATE THE BESSEL FUNCTIONS BJ0 = J0(H) AND BJ1 = J1(H) T0
! *** WITH ERROR 1.5E-08 AND 1.8EE-09 RESPECTIVELY FOR 0.LE.H.LE.1.5.

    BJ0 = (((0.641003816E-05*H2-0.433302765E-03)*H2 &
         +0.156244203E-01)*H2-0.249999838)*H2+1.0
    BJ1 = ((((.647082337E-06*H2-.541927491E-04)*H2 &
        +.260411808E-02)*H2-.624999864E-01)*H2+0.5)*H
    T1 = (.1159315157-ALG)*EV+EVE1
    R0 = T1*BJ0+2.*S0*EV+T0
    R1 = T1*BJ1+(S*BJ0/D-S0P)*EV-T0P
    RETURN

300 IF(H .GT. -.7*V) GO TO 400

! *** 0.0 .LE. H .LE. -7*V
! *** -15*SQRT(1-H*H/144) .LE. V .LE. -2

! *****************************************************************************
!   T A Y L O R   S E R I E S   A B O U T   T H E   A X I S   H = 0
! *****************************************************************************

    HDV1 = -0.5*H/V**2
    HDV2 = 0.5*H*HDV1
    T = -V

! *** COMPUTE THE FIRST FIVE COEFFICIENTS.

    P(15) = 1.0+T
    P(14) = (.25*P(15)*T+.5)*T+1.5
    P(13) = (.111111111111*P(14)*T+.666666666667)*T+3.33333333333
    P(12) = (.0625*P(13)*T+1.25)*T+8.75
    P(11) = (.04*P(12)*T+2.8)*T+25.2
    IF(H .LE. AMIN1(1.8,-0.3*V) ) GO TO 340

! *** COMPUTE THE SIXTH THROUGH TENTH COEFFICIENTS.

    P(10) = (.0277777777778*P(11)*T+7.0)*T+77.
    P(9) = (.0204081632653*P(10)*T+18.8571428571)*T+245.142857143
    P(8) = (.015625*P(9)*T+53.625)*T+804.375
    P(7) = (.0123456790123*P(8)*T+158.888888889)*T+2701.11111111
    P(6) = (.01*P(7)*T+486.2)*T+9237.8
    IF(H .LE. AMIN1(5.4,-.5*V) ) GO TO 320

! *** COMPUTE COEFFICIENTS 11 THROUGH 15.

    P(5)=(.00826446280992*P(6)*T+1526.90909091)*T+32065.0909091
    P(4)=(.00694444444444*P(5)*T+4898.83333333)*T+112673.166667
    P(3)=(.00591715976331*P(4)*T+16000.9230769)*T+400023.076923
    P(2)=(.00510204081633*P(3)*T+53064.2857143)*T+1432735.71429
    P(1)=(.00444444444444*P(2)*T+178296.)*T+5170584.

! *** ADD THE TERMS FOR R0 AND R1.

    R1 = HDV2*P(1)
    R0 = R1+P(2)
    R1 = R1+R0
    DO N = 3,15
        R0 = P(N)+R0*HDV2
        R1 = R0 + R1*HDV2
    END DO
    
    GO TO 360
    
320 R1 = HDV2*P(6)
    R0 = R1 + P(7)
    R1 = R1 + R0
    
    DO N = 8,15
        R0 = P(N) + R0*HDV2
        R1 = R0 + R1*HDV2
    END DO
    
    GO TO 360
    
340 R1 = HDV2*P(11)
    R0 = R1 + P(12)
    R1 = R1 + R0
    
    DO N = 13,15
        R0 = P(N) + R0*HDV2
        R1 = R0 + R1*HDV2
    END DO
    
360 R0 = HDV2*R0
    R1 = -HDV1*R1

! ** CALCULATE EXP(V)*RE { E1(V+I*O) } WITH ERROR .LT. 6.3E-07
! ** FOR -5.LE.V.LE.-2 AND ERROR .LT. 2.5E-07 FOR -15.LE.V.LE.-5

    IF(V.LT.-5.0) GO TO 370
    T = 2.333333333 + 0.666666667*V
    EVE1 = (((((((.00043631*T + .00116058)*T + .00214594)*T + .00477568)*T &
          +.00711876)*T-.00359751)*T-.05981647)*T-.20219760)*T-.42050903
    GO TO 380
370 T = 2.0 + 0.2*V
    EVE1 = (((((((((.00031598*T+.00022472)*T-.00104316)*T-.00221491)*T &
           -.00379725)*T-.00778794)*T-.01431797)*T-.02393537)*T &
           -.03933034)*T-.06573307)*T-.11314714
380 CONTINUE

! CALCULATE BJ0 = J0(H) TO ACCURACY 3.8E-08 FOR 0 .LE. H .LE. 9.0.
! CALCULATE BJ1 = J1(H) TO ACCURACY 8.5E-09 FOR 0 .LE. H .LE. 9.0.

    T = (0.125*H)**2
    BJ0 = (((((-3.280314134*T+21.93320794)*T-50.37621327)*T+46.122222) &
          *T-14.83889904)*T+1.000000038)/(((((.0267190315*T+.08507218164) &
          *T+.2899272453)*T+.6996287316)*T+1.161110017)*T+1.)
    BJ1 = ((((((-.2116553928*T+1.761938547)*T-5.292149869)*T &
          +6.808520292)*T-3.483633441)*T+.5000000009)/(((((.009991960769 &
          *T+.04909790276)*T+.1932152240)*T+.5455589223)*T &
          +1.032733557)*T+1.0))*H

    R0 = R0+BJ0*EVE1
    R1 = R1+EVE1*BJ1


    RETURN

400 CONTINUE
    HI = -1./H
    VDH = V*HI
    IF(VDH .GT. 0.4) GO TO 500

!   0.0 .LE. -V/H .LE. 0.4
!   1.2-.15*V .LE. 12*SQRT(1-V*V/225)

!*******************************************************************************
!        T A Y L O R  S E R I E S  A B O U T  T H E  A X I S  V = 0
!*******************************************************************************
     DATA TA /0.0,                .333333333333,      .2, &
               .142857142857,     .111111111111,      .0909090909091, &
               .0769230769231,    .0666666666667,     .0588235294118, &
               .0526315789474/
     DATA TB /0.5,                .25,                .166666666667, &
               .125,              .1,                 .083333333333, &
               .0714285714286,    .0625,              .0555555555556, &
               .05/
     DATA TC /0.0,                .166666666667,      -.075, &
               .0446428571429,    -.0303819444444,     .0223721590909, &
              -.0173527644231,    .01396484375,       -.0115518008961, &
               .00976160952919/
     DATA TD /0.0,               .5,                 -.375, &
               .3125,           -.2734375,            .24609375, &
              -.2255859375,      .209472656250,      -.196380615234, &
               .185470581055/

! CALCULATE THE FIRST 10 COEFFICIENTS.
    HDN = 0.5*H
    PE(1) = -HDN
    QE(1) = -HDN
    DO I = 2,5
        HDN = H*TA(I)
        P(I) = HDN*PE(I-1)+TC(I)
        Q(I) = HDN*QE(I-1)+TC(I)
        HDN = H*TB(I)
        PE(I) = HDN*P(I)
        QE(I) = HDN*Q(I)
    END DO
    R0 = 0.0
    R1 = 0.0
    IF(V .GE. AMAX1(-1.5,-.4*H+.15)) GO TO 430

! CALCULATE COEFFICIENTS 11 THROUGH 20
    DO I = 6,10
        HDN = H*TA(I)
        P(I) = HDN*PE(I-1)+TC(I)
        Q(I) = HDN*QE(I-1)+TC(I)
        HDN=H*TB(I)
        PE(I)=HDN*P(I)
        QE(I)=HDN*Q(I)
     END DO

! *** ADD THE TERMS FOR R0 AND R1.

    R0 = P(6)-VDH*(PE(6)-VDH*(P(7)-VDH*(PE(7)-VDH*(P(8)-VDH*(PE(8) &
        -VDH*(P(9)-VDH*(PE(9)-VDH*(P(10)-VDH*PE(10)))))))))
    R1 = Q(6)-VDH*(QE(6)-VDH*(Q(7)-VDH*(QE(7)-VDH*(Q(8)-VDH*(QE(8) &
        -VDH*(Q(9)-VDH*(QE(9)-VDH*(Q(10)-VDH*QE(10)))))))))
430 R0 = -VDH*(1.0+VDH*(PE(1)-VDH*(P(2)-VDH*(PE(2)-VDH*(P(3)-VDH &
        *(PE(3)-VDH*(P(4)-VDH*(PE(4)-VDH*(P(5)-VDH*(PE(5) &
        -VDH*R0))))))))))
    R1 = VDH*HI*(1.0+VDH*(QE(1)-VDH*(Q(2)-VDH*(QE(2)-VDH*(Q(3)-VDH &
        *(QE(3)-VDH*(Q(4)-VDH*(QE(4)-VDH*(Q(5)-VDH*(QE(5) &
        -VDH*R1))))))))))


! *** ADD (PI/2) [E0(H)~YO(H)] EXP(V) AND (PI/2) [EI(H)-YI(H)] EXP(V)
! *** TO R0 AND RI. EO AND El ARE WEBER FUNCTIONS. Y0 AND Y1 ARE
! *** BESSEL FUNCTIONS. SAME AS FOR HASKIND INTEGRAL REPRESENTATION.

    GO TO 600

500 CONTINUE
! **********************************************************************
!      HASKIND INTEGRA REPRESENTATION
! **********************************************************************

    IF(VDH .GT. 0.65) GO TO 510

! *** 0.4 .LT. -V/H .LE. 0.65
! *** 1.2-.15*V .LE. H .LE. 12*SQRT(1-V*V/225)

    Q(1) = (((-.8150342749*VDH+2.543686231)*VDH-2.592996334) &
           *VDH +.2341054441)*VDH +.9797169878
    Q(2) = ((-3.260137100*VDH+7.631058693)*VDH-5.185992667) &
           *VDH +.2341054441
    Q(3) = (-9.780411299*VDH+15.26211739)*VDH-5.185992667
    Q(4) = -19.56082260*VDH+15.26211739
    P(1) = (((-.1218591186*VDH+.5285346553)*VDH-.7530315913) &
           *VDH +.05979374853)*VDH+.9943374666
    P(2) = ((-.4874364745*VDH+1.585603966)*VDH-1.506063183) &
           *VDH+.05979374853
    P(3) = (-1.462309423*VDH+3.171207932)*VDH-1.506063183
    P(4) = -2.924618847*VDH +3.171207932
    SUMA0=(((( -2.924618847*HI+P(4))*HI+P(3))*HI+P(2))*HI &
           +P(1))*HI
    SUMA1=((((-19.56082260*HI+Q(4))*HI+Q(3))*HI+Q(2))*HI &
          +Q(1))*HI
    SUMB1 = ((((7.437788347-19.56082260*HI)*HI-.6460115208) &
           *HI-.8279710064)*HI+.8004107933)*HI
    SUMB0 = ((((2.001360393 - 2.924618847*HI)*HI-.4715495175) &
           *HI-.3201308243)*HI+.9284765359)*HI
    F0 = (((((((.8032569701E-10*H-.6046350601E-08)*H &
        +.2147241063E-06)*H-.4887479740E-05)*H+.8134065668E-04) &
        *H-.1050251826E-02)*H+.1056495999E-01)*H-.07896325119) &
        *H+.3900286185
    F1 = (((((((.7999358590E-10*H -.6019397852E-08)*H &
        +.2136492407E-06)*H-.4858423680E-05)*H+.8072687895E-04) &
        *H-.1039458089E-02)*H+.01040516731)*H-.07701510488)*H &
        +.3713839971
    T = (V+.4*H)*0.333333333333
    GO TO 540

! *** GO GET ET = EXP(V+.4*H) WITH ERROR 3.2E-10 FOR -PI.LE.V+.4*H.LE.O.

510   IF(VDH .GT. 0.85) GO TO 520

! *** 0.65 .LT .-V/H .LE. 0.85
! *** 1.2-.15*V/ .LE. H .LE. 12*SQRT(1-V*V/225)

    P(1) = (((-.1330563191*VDH+.5471174834)*VDH-.7614722211) &
        *VDH+.05947889416)*VDH+.9950036186 
    P(2) = ((-.5322252765*VDH+1.641352450)*VDH-1.522944442) &
        *VDH+.05947889416
    P(3) = (-1.596675830*VDH+3.282704901)*VDH-1.522944442 
    P(4) = -3.193351659*VDH+3.282704901
    SUMA0 = ((((-3.193351659*HI+P(4))*HI+P(3))*HI+P(2))*HI &
           +P(1))*HI
    SUMB0 = ((((-3.193351659*HI+1.207026322)*HI-.06378179472) &
           *HI-.3831259495)*HI+.8384436408)*HI
    Q(1) = (((-.5189021735*VDH+1.750445164)*VDH-1.793988619) &
          *VDH-.1245383186)*VDH+1.040237173
    Q(2) = ((-2.075608694*VDH+5.251335493)*VDH-3.587977238) &
       *VDH-.1245383186
    Q(3) =(-6.226826082*VDH+10.50267099)*VDH-3.587977238 
    Q(4) =-12.45365216*VDH+10.50267099
    SUMA1 = ((((-12.45365216*HI+Q(4))*HI*Q(3))*HI+Q(2))*HI &
          +Q(1))*HI
    SUMB1 = ((((-12.45365216*HI+2.407797079)*HI+.6079248828) &
       *HI-.8080483153)*HI+.5894157962)*HI
    F0=((((((((-.1415377098E-09*H+.9917328782E-08)*H &
        -.3185838392E-06)*H+.6296703006E-05)*H-.8689810599E-04) &
        *H+.8985362327E-03)*H-.007205044014)*H+.04469209500)*H &
       -.2044642666)*H+.6111778045
    F1= ((((((((-.1400934956E-09*H+.9810704125E-08)*H &
       -.3148842141E-06)*H+.6214797081E-05)*H-.8556791215E-04) &
       *H+.8813473055E-03)*H-.007020905584)*H+.04304811708)*H &
       -.1925417279)*H+.5449422198
    T = (V+.65*H)*0.333333333333
    GO TO 540
! *** GO GET ET = EXP(V+.65*H) WITH ERROR 3.2E-10 FOR -PI.LE.V+.65*H.LE.0.

520 IF(VDH .GT. 1.1) GO TO 530

! *** 0.85 .LT. -V/H .LE. 1.1
! *** 1.2-.15V .LE. H .LE. 12*SQRT(1-V*V/225)

    P(1)=(((-.07810899116*VDH+.3572478265)*VDH-.5146364722) &
        *VDH-.08358988759)*VDH+1.026194226
    P(2) = ((-.3124359646*VDH+1.071743480)*VDH-1.029272944) &
         *VDH-.08358988759
    P(3) = (-.9373078939*VDH+2.143486959)*VDH-1.029272944
    P(4) = -1.874615788*VDH+2.143486959
    SUMA0 = ((((-1.874615788*HI+P(4))*HI+P(3))*HI+P(2))*HI+P(1))*HI
    SUMB0 = ((((-1.874615788*HI+.5500635395)*HI+.1154860175)*HI &
            -.3760119631)*HI+.7619394103)*HI
    Q(1) = (((-.1552578526*VDH+.5131814230)*VDH-.2099381607) &
         *VDH-1.028974778)*VDH+1.234542375
    Q(2) = ((-.6210314104*VDH+1.539544269)*VDH-.4198763214) &
         *VDH-1.028974778
    Q(3) = (-1.863094231*VDH+3.079088538)*VDH-.4198763214
    Q(4) = -3.726188462*VDH+3.079088538
    SUMA1 = ((((-3.726188462*HI+Q(4))*HI+Q(3))*HI+Q(2))*HI &
           +Q(1))*HI
    SUMB1 = ((((-3.726188462*HI-.08817165515)*HI+.8512633537) &
           *HI-.6549398316)*HI+.4423454649)*HI
    F0 = (((((((((.8199079005E-10*H-.5618577690E-08)*H &
           +.1764690943E-06)*H-.3396674835E-05)*H+.4530907832E-04) &
           *H-.4493253423E-03)*H+.003454869497)*H-.02094267912)*H &
           +.09873341718)*H-.3428601747)*H+.7711679183 
    F1 = (((((((((.8073166052E-10*H-.5528635141E-08)*H &
           +.1734719968E-06)*H-.3333869864E-05)*H+.4436352482E-04) &
           *H-.4382386516E-03)*H+.003348447458)*H-.02008796342)*H &
           +.9302469016E-01)*H-.3121924010)*H+.6475797672
    T = (V+.85*H)*0.333333333333
    GO TO 540
! *** GO GET ET = EXP(V+.85*H) WITH ERROR 3.2E-10 FOR -PI.LE.V+.85*H.LE.O.

530   CONTINUE

! *** 1.1 .LT. -V/H .LE. 10/7
! *** 1.2-.15*V. LE. H FOR V .GE. -2
! *** H .LT. 12*SQRT(1.0-V*V/225)

    P(1)=(((-.02481674462*VDH+.1219805196)*VDH-.1237440567) &
         *VDH-.3732775745)*VDH+1.106986795
    P(2) = ((-.09926697847*VDH+.3659415588)*VDH-.2474881134) &
         *VDH-.3732775745
    P(3) = (-.2978009354*VDH+.7318831176)*VDH-.2474881134
    P(4) = -.5956018708*VDH+.7318831176
    SUMA0 = ((((-.5956018708*HI+P(4))*HI+P(3))*HI+P(2))*HI+P(1))*HI
    SUMB0 = ((((-.5956018708*HI+.07672105967)*HI+.1972441841) &
         *HI-.3348495614)*HI+.6726730302)*HI
    Q(1) = (((.02154215254*VDH-.2532537306)*VDH+1.040028140) &
         *VDH-1.938008993)*VDH+1.483293962
    Q(2) = ((.08616861018*VDH-.7597611917)*VDH+2.080056280) &
         *VDH -1.938008993
    Q(3) = (.2585058305*VDH-1.519522383)*VDH+2.080056280
    Q(4) = .5170116611*VDH-1.519522383
    SUMA1 = ((((.5170116611*HI+Q(4))*HI+Q(3))*HI+Q(2))*HI+Q(1))*HI
    SUMB1 = ((((.5170116611*HI-.9508095562)*HI+.7213737129) &
            *HI-.4545677076)*HI+.3043772681)*HI
    F0 = (((((((((.6780342802E-09*H-.4174016062E-07)*H &
       +.1165661433E-05)*H-.1966033214E-04)*H+.2253017954E-03) &
       *H-.1872768612E-02)*H+.01174817919)*H-.05666680040)*H &
       +.2085095563)*H-.5572950880)*H+.9499576997
    F1 = (((((((((.6595701557E-09*H-.4056174732E-07)*H &
       +.1131058481E-05)*H-.1903383823E-04)*H+.2173634348E-03) &
       *H-.1796814291E-02)*H+.01117124751)*H-.05309259858)*H &
       +.1904459019)*H-.4851591890)*H+.7395593245
    T = (V+1.1*H)*0.333333333333
! *** GO GET ET = EXP(V+1.1*H) WITH ERROR 3.2E-10 FOR -PI.LE.V+1.1*H.LE.O.

! *** CALCULATE ET.

540 T2 = T**2
    ETA = ((.0020412*T2+.10206)*T2+.898128)*T2+.864864
    ETB = (((.00010935*T2+.018370)*T2+.37422)*T2+1.297296)*T
    ET = (ETA+ETB)/(ETA-ETB)

! *** CALCULATE RO AND RI EXCEPT FOR THE ADDED SPECIAL FUNCTIONS.

     R0 = -ET*(F0+SUMB0)+SUMA0
     R1 = (ET*(F1+SUMB1)-SUMA1)*HI

600 CONTINUE

! *** ADD (PI/2) [E0(H)-Y0(H)] EXP(V) AND (PI/2) [E1(H)-y1(H)] EXP(V)
! *** TO R0 AND R1. E0 AND El ARE WEBER FUNCTIONS. Y0 AND YI ARE
! *** BESSEL FUNCTIONS.

! *** BH0 = (PI/2)*(H0(H)+Y0(H)) AND BH1 = (PI/2)*(H1(H)+Y1(H))
! *** ERROR IN BH0 .LT. 7.6 E-08 FOR 1 .LE. H .LE. 6
! *** ERROR IN BH1 .LT. 2.4 E-08 FOR 1 .LE. H .LE. 6
! *** ERROR IN BH0 .LT. 1.6 E-08 FOR 6 .LE. H .LE. 12
! *** ERROR IN BH1 .LT. 1.8 E-08 FOR 6 .LE. H .LE. 12 

    IF (H .GT. 6) GO TO 610
    T = -1.4+0.4*H
    BH0 = (((((((.10697682*T+.02861480)*T-1.25503173)*T+.20447440)*T &
        +3.84202492)*T-1.07621145)*T-3.32049215)*T+.86369090)/ &
        ((((((-.00662773*T-.00008241)*T-.06241050)*T+.00548426)*T &
        -.20941371)*T+.08904578)*T+1.0)
    BH1 = (((((((-.03380630*T-.14624308)*T+.59392539)*T+1.27350692)*T &
        -1.95999365)*T-3.19509534)*T+2.01871118)*T+2.35896024)/ &
        ((((((-.00048497*T+.00852158)*T+.00402287)*T+.11318441)*T &
        +.13088493)*T+.65471881)*T+1.0)
    GO TO 620

610 T = -3.+0.3333333333*H
    BH0 = (((((((.05540084*T-.15817848)*T-.62263549)*T+1.52099217)*T &
        +1.73139101)*T-3.11563758)*T-1.05612047)*T+.89505969)/ &
        ((((((.00166189*T-.00065708)*T+.02509944)*T-.00819426)*T &
        +.22348420)*T-.04147932)*T+1.0)
    BH1 = (((((((-.04992109*T-.09940288)*T+.72354842)*T+.84854339)*T &
        -2.75706514)*T-1.23993929)*T+2.40322266)*T+1.33966466)/ &
        ((((((.00176336*T+.00220414)*T+.02691296)*T+.02561187)*T &
        +.23302896)*T+.12286542)*T+1.0)

! *** EV = PI*EXP(V) TO ACCURACY 3.2E-07 WHEN -16 .LE. V .LE. 0.

620 EV = ((((-.000000351*V+.000009652)*V-.000326627)*V &
         +.007811604)*V-.125000204)*V+1.0
    EV = 1./((EV**2)**2)**2
     
    R0 = R0-BH0*EV
    R1 = R1+(1.-BH1)*EV
    
    RETURN
    END
